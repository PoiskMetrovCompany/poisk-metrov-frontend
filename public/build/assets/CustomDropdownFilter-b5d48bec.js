var u=Object.defineProperty;var f=(s,t,e)=>t in s?u(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var o=(s,t,e)=>(f(s,typeof t!="symbol"?t+"":t,e),e);import{w as m,g as b}from"./wasClickedOutside-18ded071.js";import{g as l}from"./getDataFromOption-f8a05e9b.js";import{f as a}from"./colors-10675ae3.js";function r(s,t,e){if(s=String(s),!["round","floor","ceil"].includes(s))throw new TypeError("The type of decimal adjustment must be one of 'round', 'floor', or 'ceil'.");if(e=Number(e),t=Number(t),e%1!==0||Number.isNaN(t))return NaN;if(e===0)return Math[s](t);const[n,i=0]=t.toString().split("e"),c=Math[s](`${n}e${i-e}`),[h,d=0]=c.toString().split("e");return+`${h}e${+d+e}`}const E=(s,t)=>r("round",s,t),N=(s,t)=>r("floor",s,t),w=(s,t)=>r("ceil",s,t),p=[];class v{constructor(t,e=void 0,n="custom-dropdown text-item"){o(this,"buttonId",null);o(this,"searchController",null);o(this,"button",null);o(this,"container",null);o(this,"options",null);o(this,"icon",null);o(this,"defaultContainerClass","");o(this,"defaultFilterClass","");o(this,"isOpen",!1);o(this,"allowMultiple",!0);o(this,"sendRequestOnChange",!0);o(this,"counter",null);o(this,"activeOptions",0);o(this,"title",null);o(this,"defaultTitle",null);o(this,"defaultTitleColor");o(this,"addObjectTemplate");e!=null&&(this.buttonId=e),this.searchController=t,this.button=document.getElementById(this.buttonId),this.container=this.button.querySelector(".custom-dropdown.base-container"),this.counter=this.button.querySelector(".filter.counter"),this.title=this.button.getElementsByTagName("span")[0],this.defaultTitle=this.title.textContent,this.defaultTitleColor=window.getComputedStyle(this.title).color,this.icon=this.button.querySelector(".arrow-tailless"),this.defaultContainerClass=this.container.className,this.defaultFilterClass=this.button.className,this.allowMultiple=this.container.getAttribute("allowMultiple")=="1",p.push(this),this.button.setAttribute("tabindex",-1),this.button.addEventListener("focusin",i=>{this.open()}),this.button.addEventListener("click",i=>{this.isOpen&&(i.target==this.button||i.target.parentElement==this.button&&(i.target.tagName=="SPAN"||i.target.className.includes("icon")))&&this.close()}),this.button.addEventListener("focusout",i=>{m(this.button)&&this.close()}),document.addEventListener("filterChanged",i=>{i.filterId!=this.buttonId&&this.close()}),document.addEventListener("searchItemAdded",i=>{i.filter==this&&(this.activeOptions++,this.onActiveOptionsChanged(i),this.allowMultiple||this.close())}),document.addEventListener("searchItemRemoved",i=>{i.filter==this&&(this.activeOptions--,this.onActiveOptionsChanged(i))}),this.options=Array.from(this.container.getElementsByClassName(n)),this.options.forEach(i=>i.addEventListener("click",()=>this.onOptionClicked(i))),this.options.length>0?this.addObjectTemplate=l(this.options[0]):(this.button.style.cursor="not-allowed",this.button.style.opacity=.5),document.addEventListener("parameterLoadedFromSearch",i=>this.onParameterLoadedFromSearch(i))}onParameterLoadedFromSearch(t){this.options.forEach(e=>{const n=l(e);n.condition==t.condition&&n.value==t.value&&n.field==t.field&&this.onOptionClicked(e)})}indexOfOption(t){return Array.from(t.parentElement.children).indexOf(t)}onOptionClicked(t){const e=l(t);e.filter=this;const n=t.getElementsByClassName("pseudo-checkbox")[0];n&&(e.checkbox=b(n.getAttribute("checkboxid")));let i=!1;this.searchController.getItemWithId(e.searchid)&&(i=!0),this.searchController.addOrRemoveItemWithId(e),i&&this.sendRequestOnChange&&this.searchController.submitSearch()}onActiveOptionsChanged(t){if(this.counter!=null){switch(this.counter.textContent=this.activeOptions,this.activeOptions){case 0:this.counter.style.visibility="hidden",this.title.textContent=this.defaultTitle,this.title.style.color=this.defaultTitleColor;break;case 1:if(this.counter.style.visibility="hidden",t.type=="searchItemAdded")this.title.textContent=t.displayName;else{const e=this.searchController.searchItems.find(n=>n.filter==this);this.title.textContent=e?e.displayName:this.defaultTitle}this.title.style.color=a;break;default:this.counter.style.visibility="visible",this.title.textContent=this.defaultTitle,this.title.style.color=a;break}this.options.forEach(e=>{const n=l(e);n.searchid==t.searchid&&n.value==t.value&&(t.type=="searchItemAdded"&&(e.className+=" selected"),t.type=="searchItemRemoved"&&(e.className=e.className.replace(" selected","")))})}}open(){if(this.options.length==0)return;this.container.classList.add("open"),this.button.classList.add("selected"),this.icon.style.rotate="180deg";const t=new Event("filterChanged");t.filterId=this.buttonId,document.dispatchEvent(t),setTimeout(()=>this.isOpen=!0,300)}close(){this.container.classList.remove("open"),this.button.classList.remove("selected"),this.icon.style.rotate="0deg",this.isOpen=!1,this.button.blur()}}export{v as C,E as a,w as c,N as f,p as r};
