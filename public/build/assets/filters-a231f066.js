var c=Object.defineProperty;var d=(o,t,r)=>t in o?c(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r;var e=(o,t,r)=>(d(o,typeof t!="symbol"?t+"":t,r),r);import{S as m,a as u,P as p,B as n,b as g,c as a}from"./ButtonsGrid-3639f438.js";import{C as s}from"./CustomDropdownFilter-b5d48bec.js";import{F as C,A as S,K as w}from"./KitchenFromToDropdownFilter-89fe7d8c.js";import{a as f}from"./axios-1779699b.js";import{l as h}from"./apartmentCardDropdowns-17a5c557.js";import"./getDataFromOption-f8a05e9b.js";import"./wasClickedOutside-18ded071.js";import"./colors-10675ae3.js";import"./paginator-3d74c680.js";import"./TabsGrid-2aad9bf8.js";import"./loadPlanCardButtons-079e20a2.js";import"./cookies-2118fce7.js";import"./sharePageMenu-adc27c4b.js";import"./chart-43d2a988.js";import"./menu-135c7b1f.js";class E{constructor(){e(this,"searchController");e(this,"searchBubbles");e(this,"roomsFilter");e(this,"yearsFilter");e(this,"finishingFilter");e(this,"toiletFilter");e(this,"metroFilter");e(this,"registrationFilter");e(this,"mortgageFilter");e(this,"apartmentFilter");e(this,"corpusFilter");e(this,"yearsButtons");e(this,"roomsButtons");e(this,"metroButtons");e(this,"finishingButtons");e(this,"toiletButtons");e(this,"registrationButtons");e(this,"paymentButtons");e(this,"apartmentButtons");e(this,"corpusButtons");e(this,"pricesDropdown");e(this,"floorsDropdown");e(this,"areaDropdown");e(this,"kitchenAreaDropdown");e(this,"priceRange");e(this,"floorsRange");e(this,"areaRange");e(this,"kitchenAreaRange");e(this,"menuObject");e(this,"openMenuButton");e(this,"closeMenuButton");e(this,"offset",0);e(this,"limit",18);e(this,"isLoading",!1);e(this,"defaultMenuClass");e(this,"searchRangeSliders",[]);e(this,"apartmentDropdownsContainer");e(this,"nothingFound");e(this,"priceSortingForRoomCount",{});e(this,"areaSortingForRoomCount",{});this.searchController=new m,this.searchBubbles=new u(this.searchController,!0),this.yearsFilter=new s(this.searchController,"filter-years-number","names-dropdown item"),this.toiletFilter=new s(this.searchController,"filter-toilet","names-dropdown item"),this.finishingFilter=new s(this.searchController,"filter-finishing","names-dropdown item"),this.mortgageFilter=new s(this.searchController,"filter-mortgage","names-dropdown item"),this.apartmentFilter=new s(this.searchController,"filter-apartments","names-dropdown item"),this.corpusFilter=new s(this.searchController,"filter-corpus","names-dropdown item"),this.pricesDropdown=new p(this.searchController,"filter-price"),this.floorsDropdown=new C(this.searchController,"filter-floors"),this.areaDropdown=new S(this.searchController,"filter-area"),this.kitchenAreaDropdown=new w(this.searchController,"filter-kitchen-area"),this.yearsButtons=new n(this.searchController,"years-buttons",!0),this.corpusButtons=new n(this.searchController,"corpus-buttons",!0),this.finishingButtons=new n(this.searchController,"finishing-buttons",!0),this.toiletButtons=new n(this.searchController,"toilet-buttons",!0),this.paymentButtons=new n(this.searchController,"payment-methods-buttons",!0),this.apartmentButtons=new n(this.searchController,"apartments-buttons",!0),this.priceRange=new g("price-min-max-range",this.pricesDropdown),this.floorsRange=new a("floor-min-max-range",this.floorsDropdown),this.areaRange=new a("area-min-max-range",this.areaDropdown),this.kitchenAreaRange=new a("kitchen-area-min-max-range",this.kitchenAreaDropdown),this.searchRangeSliders=[this.priceRange,this.floorsRange,this.areaRange,this.kitchenAreaRange],this.loadMenu(),this.searchController.loadParametersFromSearchBar(),this.searchController.sendSearchParams=t=>this.sendSearchRequest(t),document.addEventListener("searchItemAdded",()=>this.searchController.submitSearch()),document.addEventListener("searchItemsCleared",()=>this.submitSearchWithClear()),document.addEventListener("priceSortingChanged",t=>this.onPriceSortingChanged(t)),document.addEventListener("areaSortingChanged",t=>this.onAreaSortingChanged(t)),h(this.priceSortingForRoomCount,this.areaSortingForRoomCount)}loadMenu(){this.openMenuButton=document.getElementById("show-filters-menu-mobile"),this.closeMenuButton=document.getElementById("close-filter-menu-button"),this.menuObject=document.getElementsByClassName("plans-filter filters-container")[0],this.defaultMenuClass=this.menuObject.className,this.menuObject.addEventListener("submit",t=>this.onSubmit(t)),this.openMenuButton.addEventListener("click",()=>{this.menuObject.className.endsWith("open")?this.menuObject.className=this.defaultMenuClass:this.menuObject.className=this.defaultMenuClass+" open"})}onPriceSortingChanged(t){let r="ASC";(t.text="Сначала дороже")&&(r="DESC"),this.priceSortingForRoomCount[t.apartmentType]||(this.priceSortingForRoomCount[t.apartmentType]=[]),this.priceSortingForRoomCount[t.apartmentType][t.roomCount]=r,this.searchController.submitSearch()}onAreaSortingChanged(t){let r="ASC";(t.text="По росту площади")&&(r="DESC"),this.areaSortingForRoomCount[t.apartmentType]||(this.areaSortingForRoomCount[t.apartmentType]=[]),this.areaSortingForRoomCount[t.apartmentType][t.roomCount]=r,this.searchController.submitSearch()}onSubmit(t){t.preventDefault(),this.submitSearchWithClear(),this.menuObject.className=this.defaultMenuClass}submitSearchWithClear(){this.offset=0,this.searchController.submitSearch()}emitSearchStartEvent(){const t=new Event("searchStarted");document.dispatchEvent(t)}emitSearchEndEvent(t){const r=new Event("searchEnded");r.response=t,document.dispatchEvent(r)}async sendSearchRequest(t){if(this.isLoading)return;this.isLoading=!0,this.apartmentDropdownsContainer=document.getElementById("apartment-dropdowns-container"),this.nothingFound=document.getElementById("nothing-found");const r=window.location.href.substring(window.location.href.lastIndexOf("/")+1).split("?")[0];t.priceSortOrder=Array.from(this.priceSortingForRoomCount),t.areaSortOrder=Array.from(this.areaSortingForRoomCount),this.apartmentDropdownsContainer.style.opacity=.5,this.emitSearchStartEvent();const i=await f.get(`/apartments-list/${r}`,{params:t});this.emitSearchEndEvent(i),this.nothingFound.style.display=i.data==""?"block":"none",this.apartmentDropdownsContainer.style.opacity=1,this.apartmentDropdownsContainer.innerHTML=i.data,h(this.priceSortingForRoomCount,this.areaSortingForRoomCount),this.isLoading=!1}resetSliders(){this.searchRangeSliders.forEach(t=>t.resetSlider())}}class F{constructor(t,r,i){e(this,"searchStartEvent");e(this,"searchEndEvent");e(this,"dotsId");this.searchStartEvent=t,this.searchEndEvent=r,this.dotsId=i,document.addEventListener(this.searchStartEvent,()=>this.onSearchStart()),document.addEventListener(this.searchEndEvent,l=>this.onSearchEnd(l))}onSearchStart(){const t=document.getElementById(this.dotsId);t.style.display="flex"}onSearchEnd(t){const r=document.getElementById(this.dotsId);r.style.display="none"}}document.addEventListener("DOMContentLoaded",()=>{new E;const o="searchStarted",t="searchEnded";new F(o,t,"apartments-loader-dots")});
