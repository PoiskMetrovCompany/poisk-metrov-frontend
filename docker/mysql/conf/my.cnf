[mysqld]
# === Общие настройки ===
user                            = mysql
pid-file                        = /var/run/mysqld/mysqld.pid
socket                          = /var/run/mysqld/mysqld.sock
datadir                         = /var/lib/mysql
log-error                       = /var/log/mysql/error.log
port                            = 3306
# === Сетевые настройки ===
bind-address                    = 0.0.0.0
skip-name-resolve               # Ускоряет подключения, отключает DNS-проверки
# === Кодировки и collation ===
character-set-server            = utf8mb4
collation-server                = utf8mb4_unicode_ci
# === Логирование ===
log-bin                         = /var/lib/mysql/mysql-bin
server-id                       = 1
binlog_expire_logs_seconds      = 604800  # 7 дней в секундах
# === InnoDB (основной движок) ===
innodb_file_per_table           = 1
innodb_flush_log_at_trx_commit  = 1
innodb_log_buffer_size          = 16M
innodb_buffer_pool_size         = 256M
innodb_log_file_size            = 64M
# === Подключения ===
max_connections                 = 200
max_connect_errors              = 1000000
connect_timeout                 = 10
wait_timeout                    = 28800
interactive_timeout             = 28800
# === Безопасность ===
secure-file-priv                = NULL
# ИСПРАВЛЕНО: Удален NO_AUTO_CREATE_USER (устарел в MySQL 8.0)
sql_mode                        = STRICT_TRANS_TABLES,NO_ZERO_DATE,NO_ZERO_IN_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION

# === Мониторинг ===
performance_schema              = ON

[client]
# ИСПРАВЛЕНО: Согласован путь к сокету
socket                          = /var/run/mysqld/mysqld.sock